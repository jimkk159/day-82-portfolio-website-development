{% import "bootstrap/wtf.html" as wtf %}
{% include "header.html" %}
<!-- Page Header -->
<header class="masthead">
    <div class="overlay"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-md-10 mx-auto">
                <div class="post-heading">
                    <h1>{{ blog_post.title }}</h1>
                    <h2 class="subheading">{{ blog_post.subtitle }}</h2>
                    <span class="meta">Posted by
              <a href="{{ url_for('user.personal_site', user_id=blog_post.author.id) }}">{{ blog_post.author.name }}</a>
              on {{ blog_post.date }}</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-md-10 mx-auto">
                {{ blog_post.body | safe }}
            </div>
            <div class="col-lg-8 col-md-10 mx-auto">
                <p>
                    {% for tag in blog_post.tags %}
                    {{ tag.name }}
                    {% endfor %}
                </p>
            </div>
            {% if current_user.is_authenticated and ( current_user.id == blog_post.author.id or current_user.id == 1 )
            %}
            <div class="col-lg-8 col-md-10 mx-auto">
                <a class="btn btn-primary float-right"
                   href="{{ url_for('blog.edit_blog_post', edit_post_id=blog_post.id) }}">Edit</a>
            </div>
            {% endif %}

        </div>
    </div>
    <hr>
    {% for blog_comment in blog_post.comments %}
    <div class="container">
        <div class="row">
            <div class="commenterImage">
                <a href="{{ url_for('user.personal_site', user_id=blog_comment.author.id) }}"><img src="{{ blog_comment.author.email | gravatar }}" /></a>
            </div>
            <div class="col-lg-8 col-md-10 mx-auto">
                {{ blog_comment.body | safe }}
                <span class="meta">Posted by<a
                        href="{{ url_for('user.personal_site', user_id=blog_comment.author.id) }}">{{ blog_comment.author.name }}</a>on {{ blog_comment.date }}</span>
                {% if current_user.is_authenticated and (current_user.id == blog_comment.author.id or current_user.id
                == 1 ) %}
                <a href="{{ url_for('blog.delete_comment', comment_id=blog_comment.id) }}"><img
                        src="{{ url_for('static',filename='img/cross.png') }}" style="width:1rem"></a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</article>

<hr>

<!-- Comment -->
{% if current_user.is_authenticated %}
<div class="container">
    <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
            {{ ckeditor.load() }}
            {{ ckeditor.config(name='comment') }}
            {{ wtf.quick_form(comment_form, novalidate=True, button_map={"submit":"primary"}) }}
        </div>
    </div>
</div>
{% endif %}
<hr>
{% include "footer.html" %}

